# Fine-Tuning (Tensorflow)
Using textual inversion to fine tune keras' Stable Diffusion model in order to combine two rather opposed concepts like broccoli and emotions in a certain style in Tensorflow. Training and testing a pretrained ResNet to classify the emotion depicted in the generated images. 

# Usage: 
The code for training the finetuning model and generating images is to be found in the folders "four_emotions" and "two_concepts". Each includes a training.ipynb which can be used for training new weigths on the task, a textual_inversion.py and an image_generation.ipynb, which can be used for generating new images of broccoli with emotions, using either own pretrained weights or weights provided by us. 

Choose whether to use "four_emotions" or "two_concepts" depending on whether you want images generated by training on the emotions "happy", "sad", "angry" and "in love" at the same time or whether to train the concept of a broccoli sticker and the concept of an emoji simultaneously and later combining them.

For training, you can either continue with weigths saved in a numpy array or start a new training. 
For the former, mount your Google Drive and insert the name of your own numpy array stored in your Google Drive where indicated in the coments.
Afterwards, choose how many epochs you want to train for, whther to train with seeing the development of the image after each epoch or not, and where to save your new weights. 

For image generation, choose where to loas weights from. Either execute the code as ist is and load our pretrained weights, or insert your own path. Afterwards, you can choose a prompt, the number of images to be generated and a fixed seed if wanted. Execute the cell for storing the images in your Google Drive or the one for showing the images in the notebook. You may have to save a folder "Images" in you Google Drive before doing so.
When generating images with two concepts, choose whether to generate images by concept interpolation or by combining concepts in the prompt.

The file "ResNet.ipynb" contains the pretrained, customized ResNet50 used by us including image preprocessing. The images used are stored in the folder "dataset" and contain only images that contain enough features of broccoli and the respective emotion.

    License: Specify the license under which your project is released. This is important because it tells others how they can use your code.

    Contact Information: Provide a way for users to contact you if they have questions or need support.

    Acknowledgments: If you used any third-party libraries or tools in your project, give credit to the authors and provide links to their websites.
